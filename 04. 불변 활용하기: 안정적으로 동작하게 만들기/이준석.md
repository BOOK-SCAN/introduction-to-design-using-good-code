# 📌 04. 불변 활용하기 : 안정적으로 동작하게 만들기

### 📌 재할당

- 재할당 : 변수에 값을 다시 할당하는 것 (=파괴적 할당)
- 재할당은 변수의 의미를 추측하기 어렵게 만듦
- 이러한 것을 막기위해 계속해서 새로운 변수를 만들어 사용하는 방식이 선호됨
- 불변변수로 재할당 막기 : final을 변수나 매개변수에 붙여 불변변수로 만들어 연산

### 📌 가변으로 인해 발생하는 의도하지 않은 영향

- 사례 1. 가변 인스턴스 재사용하기 : 한가지 인스턴스를 여러곳에서 재사용하게 되면 한쪽의 변경이 다른쪽에 영향을 끼칠 수 있다. 이를 막기 위해서 인스턴스를 개별적으로 생성할 수 있게 바꾸고 재사용하지 못하게 한다
- 사례 2. 함수로 가변 인스턴스 조작하기 : 함수로 가변 인스턴스를 조작하면 다른 스레드에서 사용되어 예상치 못한 부수효과를 가져올 후 있다.
    - 부수효과 : 함수가 매개변수를 받고 값을 리턴하는 것 외에 외부상태를 변경하는 것
        - 인스턴스 변수 변경
        - 전역변수 변경
        - 매개변수 변경
        - 파일 읽고 쓰기같은 I/O 조작
    - 따라서 함수는 다음을 만족하도록 설계하는 것이 좋음
        - 데이터(상태)는 매개변수로 받는다
        - 상태를 변경하지 않는다.
        - 값은 함수의 리턴값으로 돌려준다.
- 위와 같은 상황들을 막기 위해 변수들을 불변으로 만들고, 변경하려면 새로운 인스턴스를 만들어서 사용해야 한다.

### 📌 불변과 가변은 어떻게 다루어야 할까

- 불변변수의 장점
    - 변수의 의미가 변하지 않으므로 혼란을 줄일수 있다.
    - 동작이 안정적이게 되므로 결과를 에측하기 쉽다.
    - 코드의 영향 범위가 한정적이므로, 유지보수가 편리해진다.
- 대량의 데이터를 빠르게 처리하는 경우나, 리소스의 제약이 큰 소프트웨어를 다루는 것처럼 성능이 중요한 경우 가변변수를 사용하는 것이 좋다.
- 가변변수를 사용하는 경우 상태를 바꾸는 메서드(뮤테이터)를 올바르게 만들어야 한다.
- 코드 외부와의 데이터 교환은 국소화 해야한다.

# ❓ Question

---

### ❓ 3주차 문제 해결

- 3주차 궁금증 :  어차피 다시 만들거면 왜 귀찮게 새로 만들게 하나
- 인스턴수 변수가 계속해서 값이 바뀌면, 예상치 못한 부수효과가 있다고 한다. 그래서 인스턴트 변수를 불변변수로 만들었다. 근데 또 변경하고 싶은 경우가 있을 수도 있으니 생성자를 통해 새로운 인스턴트 변수를 생성하는 식으로 변경을 할 수 있다고 한다. 근데 애초에 바꾸지 못하게 할라고 막은건데 다시 할 수 있다면 왜 막은건가? ⇒ 근데 책에서 말한 의미가 이건 아닌 것 같다. 인스턴스 값이 바뀌는 게 문제여서 막은 게 아니고, 바꾸는 방식이 문제여서 새로 생성하고 바꾸는 방식으로 바꾼 것이다.
- 그러면 왜 기존의 것을 그냥 바꾸는 식이 안좋은 것인가
- ⇒ 기존의 것을 재활용해서 쓰는 방식이라면 위의 사례 1,2와 같은 문제가 발생 가능하기 때문에 새롭게 만드는 방식으로 해야한다.
